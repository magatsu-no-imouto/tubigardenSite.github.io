<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Home Page</title>
    <style>
@media print{
    header,button{display:none}
    select{
        border: none;
        outline: none;
    }
    /* Hide the scrollbar for the table */
    .table-container {
        overflow: visible !important;
    }

    /* Remove unnecessary margins and paddings */
    table {
        margin-bottom: 0;
    }

    /* Adjust font size or other styles if needed for better printing */
    th, td {
        /* Adjust the font size as needed */
        font-size: 12px;
    }
}
body {
    font-family: Arial, Helvetica, sans-serif;
            background-color: #f2f2f2;
            margin: 0;
            padding: 0;
            display:inline-flexbox;
            justify-content: center;
            align-items: center;
            height: 100vh;
           
            background-image: url('media/tubigan.jpg'); 
    background-repeat: no-repeat;
    background-size: cover;
    background-attachment: fixed;
    background-size: cover; 
    background-position: center;
    background-repeat: no-repeat; 
    margin: 0; 
    padding: 0;
           
   
        }
      
h2{
    color: #080808;
}
       
    .header-content {
      position: relative;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #fff;
    }
        header.style1 {
        display: flex;
        background-color: #007BFF;
        color: #fff;
        text-align: center;
        padding: 5px ;
        }
        header.style1 a {
         display: inline-block;
         background-color: #fff;
         color: #007BFF;
         padding: 10px 20px;
         text-decoration: none;
         border-radius: 5px;
         margin-top: 20px;
         font-weight: bold;
        }
        div.style1 {
    padding: 50px 0px 0px 155px;
}

        header.style2 {
           background-color: #7cafc9;
           color: #ffffff;
          text-align: center;
          padding: 5px ;
        }
        header.style2 a {
         display: inline-block;
         background-color: #fff;
         color: #007BFF;
         padding: 10px 20px;
         text-decoration: none;
         border-radius: 5px;
         margin-top: 20px;
         font-weight: bold;
        }
        
        header.s2 nav{
          display: flex;
          justify-content: center;
          align-items: center;
        }
        header.style2 nav a{
          display: inline-block;
          padding: 10px 20px;
          text-decoration: none;
          color: #ff0202;
          background-color: rgb(226, 226, 83);
          border-radius: 35px;
          margin: 0 10px;
          transition: cubic-bezier(0.075, 0.82, 0.165, 1);
        }
        header.style2 nav a:hover{
          background-color: #007BFF;

        }
        
        .table-container {
            width: 95%;
            height: 500px;
            margin: 0 auto;  
            padding: 5px;
            overflow-x: auto;
            overflow-y: auto;
            border-radius: 10px;
            backdrop-filter: blur(100%);
            background-color: rgba(233, 230, 230, 0.8);
            box-shadow: 0 60px 80px rgba(0, 0, 0, 0.1);
            opacity: 100%;
            border: 1px;
        }

        table {
            width:90%;
            margin: 0 auto; 
            border-collapse: collapse;
            margin-bottom: 20px;
        }


        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: justify;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        footer {
         text-align: center;
         background-color: #333;
         color: #fff;
         padding: 0px ;
         margin-top: 200px;
        }
        select {
            width: 25%;
            padding: 10px;
            margin-bottom: 15px;
            border: 0px solid #ccc;
            border-radius: 4px;
        }
        .btn {
            padding: 10px 30px;
            background-color: #007bff;
            color: #fff;
            text-decoration: none;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        .main-heading{
    font-size: 20px;
    display: inline-block;
    justify-content: center;
    text-align: center;
    margin-right: 340px;

}
.headText{
        font-size: 15px;
        display: inline-block;
justify-content: center;
text-align: center;
margin-right: 340px;
}
header {
      flex: 1;
      position: relative;
      overflow: hidden;
    }
    header > img {
    height: 100px;
    width: auto;
    margin-right:auto;
    margin-left: - auto;
}
.linkWithFunction{
    cursor: pointer;
}
    </style>
    <style media="screen">
        .noPrint{ display: block; }
        .yesPrint{ display: block !important; }
      </style>
      
      <style media="print">
        .noPrint{ display: none; }
        .yesPrint{ display: block !important; }
      </style>
</head>
<body>
    <header class="style1">
        <img src="media/5.png" alt="logo">

        <div class="style1">
        <h1 class="main-heading"> Tubigan Garden Resort</h1>
        <p class="headText">Tubigan Garden Resort located at Paliparan 3, Dasmari√±as, Cavite | ùôîùôäùôêùôç ùôâùôÄùôìùôè ùòºùòøùôëùôÄùôâùôèùôêùôçùôÄ ùôéùôãùôäùôè‚ùó</p>
        <p class="headText">Affordable Summer PlayGround</p><br>
        </div>
    </header>

    <header class="style2 noPrint">
        <nav>
        <a href= "AdminUser.html">Admin Accounts</a>
        <a href= "AdminMembers.html">Member Accounts</a>
        <a href= "AdminReshced.html">Reschedules</a>
        <a href="AdminSchedule.html">Schedule</a>
        <a href="AdminRunBal.html">Customer's Running Balance</a>
        <a href="AdminPromos.html">Promos</a>
        <a href="AdminRooms.html">Rooms</a><br><br>
        <a href="AdminCheckin.html">Check-In A Customer</a>
        <a class="linkWithFunction" onclick="logout()">Log Out</a>
        </nav>
    </header>

    
    <h2>Business Report</h2>
    <div class="container yesPrint">
        <select id="FilterA">
            <option>NO FILTER</option>
            <option value="Payment Status">Payment Status</option>
            <option value="Reservation Status">Reservation Status</option>
            <option value="Profit">Profit</option>
            <option value="Chosen Room">Chosen Room</option>
        </select>
        <select id="FilterB" hidden>
            <option></option>
            <option>Daily</option>
            <option>Weekly</option>
            <option>Monthly</option>
            <option>Yearly</option>
        </select>
        <select id="FilterC" hidden>
            <option></option>
        </select>
        <div class="table-container yesPrint">
            <table id="datum">
                <thead id="dataHead">
                    <th>Check In Date</th>
                    <th>Check Out Date</th>
                    <th>Reservation ID</th>
                    <th>Customer Name</th>
                    <th>Chosen Room</th>
                    <th>Touring Package</th>
                    <th>Total Price</th>
                    <th>Running Balance</th>
                    <th>Payment Status</th>
                    <th>Reservation Status</th>
                </thead>
                <tbody id="dataBody">
                    <!--We both know how this goes.-->
                </tbody>
            </table>
        </div><br>
        <button class="btn noPrint" onclick="printo()">Print</button>
        <!--<button class="btn noPrint" onclick="window.print()">Print</button>-->

    </div>
    <input hidden id="startD" type="date">
    <input hidden id="endD" type="date">
    <footer>
        <p>&copy; (2014) Tubigan Garden Resort</p>
    </footer>
        
<script>


        const dt=new Date
        var monthNames = ["January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"
];

//#region Data-Fillers Native

fetch('/reservation-data').then(response => {
    if (response.ok) {
      return response.json(); 
    } else {
      throw new Error('Error fetching data');
    }
  })
  .then(async data =>{
    const Data=document.getElementById('dataBody');
    let runBal="N/A"
    for(const item of data){
        try{
        const RunBalCheck=await fetch(`/searchRunRes?runresID=${item.resID}`)
        const RunBalDat=await RunBalCheck.json()
        if(RunBalCheck.ok){
            runBal=RunBalDat.runresBal
        }
    }catch(err){console.log("ERROR",err)}
    const r=document.createElement('tr');
    r.innerHTML=`
    <td>${item.resCheckinDate}</td>
    <td>${item.resCheckoutDate}</td>
    <td>${item.resID}</td>
    <td>${item.resmName}</td>
    <td>${item.resRoomName}</td>
    <td>${item.resTour}</td>
    <td>${item.resPrice}</td>
    <td>${runBal}</td>
    <td>${item.resPayStat}</td>
    <td>${item.resStat}</td>
    `;
    Data.appendChild(r);
    }
    reportData()
})

async function resData(){
    const response=await fetch('/reservation-data')
    const result=await response.json()
    if(response.ok){
        const Data=document.getElementById('dataBody');
    let runBal="N/A"
    for(const item of result){
        try{
        const RunBalCheck=await fetch(`/searchRunRes?runresID=${item.resID}`)
        const RunBalDat=await RunBalCheck.json()
        if(RunBalCheck.ok){
            runBal=RunBalDat.runresBal
        }
    }catch(err){console.log("ERROR",err)}
    const r=document.createElement('tr');
    r.innerHTML=`
    <td>${item.resCheckinDate}</td>
    <td>${item.resCheckoutDate}</td>
    <td>${item.resID}</td>
    <td>${item.resmName}</td>
    <td>${item.resRoomName}</td>
    <td>${item.resTour}</td>
    <td>${item.resPrice}</td>
    <td>${runBal}</td>
    <td>${item.resPayStat}</td>
    <td>${item.resStat}</td>
    `;
    Data.appendChild(r);
    }
    reportData()
    }
}

async function reportData(){
    try{
        const response=await fetch('/reservation-data-r')
        const result=await response.json()
        if(response.ok){
    const Data=document.getElementById('dataBody');
    result.forEach(item=>{
            const r=document.createElement('tr');
    r.innerHTML=`
    <td>${item.resCheckinDate}</td>
    <td>${item.resCheckoutDate}</td>
    <td>${item.resID}</td>
    <td>${item.resmName}</td>
    <td>${item.resRoomName}</td>
    <td>${item.resTour}</td>
    <td>${item.resPrice}</td>
    <td>N/A</td>
    <td>${item.resPayStat}</td>
    <td>${item.resStat}</td>
    `;
    Data.appendChild(r);
    })
    sortTable()
        }
    }catch(err){
        console.log("Error! ",err)
    }
  }

  function sortTable() {
  var table, rows, switching, i, x, y, shouldSwitch;
  table = document.getElementById("datum");
  switching = true;

  while (switching) {
    switching = false;
    rows = table.rows;

    for (i = 1; i < rows.length - 1; i++) {
      shouldSwitch = false;
      x = rows[i].getElementsByTagName("td")[0];
      y = rows[i + 1].getElementsByTagName("td")[0];

      // Convert the date strings to Date objects for comparison
      var dateX = new Date(x.textContent);
      var dateY = new Date(y.textContent);

      if (dateX > dateY) {
        shouldSwitch = true;
        break;
      }
    }

    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    }
  }
}
//#endregion

//#region Filter Function
let startDate, endDate,whatGet="",whatLook;
const roomArray=[
    {
        roomName:"Funny Room"
    },{
        roomName:"Funnier Room"
    },{
        roomName:"The Funniest Room"
    }
]
let roomArrayF=[]
let roomGet=[]
const reload=[]
const arrayTest=[
    {
        text:"waaario",
        filter:"100",
        date:"2023-11-26",
        roomName:"Funny Room",
        payStat:"Paid",
        resStat:"Checked Out"
    },
    {
        text:"aaa",
        filter:"120",
        date:"2023-12-26",
        roomName:"Funny Room",
        payStat:"Paid",
        resStat:"Checked Out"
    },
    {
        text:"ass",
        filter:"2",
        date:"2023-12-27",
        roomName:["Funny Room","Funnier Room"],
        payStat:"Paid",
        resStat:"Checked In"
    },
    {
        text:"assw",
        filter:"150",
        date:"2023-12-28",
        roomName:"The Funniest Room",
        payStat:"Paid",
        resStat:"Reserved"
    },
    {
        text:"aasdfsa",
        filter:"222",
        date:"2023-12-29",
        roomName:"Funny Room",
        payStat:"Paid",
        resStat:"Reserved"
    },
    {
        text:"asvsaa",
        filter:"112",
        date:"2023-12-30",
        roomName:"Funnier Room",
        payStat:"Unpaid",
        resStat:"Reserved"
    },
    {
        text:"avdd",
        filter:"442",
        date:"2023-12-31",
        roomName:"Funny Room",
        payStat:"Unpaid",
        resStat:"Reserved"
    },
    {
        text:"awww",
        filter:"120",
        date:"2024-01-01",
        roomName:"Funnier Room",
        payStat:"Paid",
        resStat:"Checked In"
    },
    {
        text:"aeee",
        filter:"25",
        date:"2024-01-02",
        roomName:"Funnier Room",
        payStat:"Paid",
        resStat:"Reserved"
    }
]

let totProfit=0,totRoom=0,totPaid=0,totUnPaid=0,totHfPaid=0
let arrayFlag=0
let presentCount=0
async function filterPlsPtA(){
    console.log(arrayFlag+" "+totProfit+" "+totRoom+" "+totPaid+" "+totUnPaid+" "+totHfPaid)
    arrayFlag=0
    totProfit=0,totRoom=0,totPaid=0,totUnPaid=0,totHfPaid=0
    console.log(arrayFlag+" "+totProfit+" "+totRoom+" "+totPaid+" "+totUnPaid+" "+totHfPaid)
    console.log(whatGet+" "+whatLook)
    console.log(roomGet.length)
    roomGet=[]
    console.log(roomGet.length)
document.getElementById('startD').valueAsDate=startDate
document.getElementById('endD').valueAsDate=endDate
const start=document.getElementById('startD')
const end=document.getElementById('endD')
const tbl=document.getElementById('dataBody')
tbl.innerHTML=``
//try-catch fetch reservation-data, for loop the data. replace arrayTest[e] with result or something
const response=await fetch('/reservation-data')
const result=await response.json()
for(const item of result){
    if(start.value<=item.resCheckinDate && item.resCheckinDate<=end.value){
        if(whatLook=="payStatFilter"){
            if(whatGet==item.resPayStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else 
        if(whatLook=="resStatFilter"){
            if(whatGet==item.resStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else{
                console.log('n/a')
            }
        }else 
        if(whatLook=="roomFilter"){
            if(Array.isArray(item.resRoomName)){
                    for(const ex of item.resRoomName){
                        if(ex==whatGet){
                            totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(ex==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==ex && ex==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==ex){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                    }
                                }
                            }
                        }
                    }
                }else{
                    if(item.resRoomName==whatGet){
                        totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(item.resRoomName==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==item.resRoomName && item.resRoomName==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==item.resRoomName){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                }
        }else 
        if(whatLook=="profitFilter"){
            totProfit=parseFloat(totProfit)+parseFloat(item.resPrice)
            totRoom=parseInt(totRoom)+1
        }
    }else{
        if(startDate==undefined && endDate==undefined){
        if(whatLook=="payStatFilter"){
            if(whatGet==item.resPayStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else 
        if(whatLook=="resStatFilter"){
            if(whatGet==item.resStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else
            if(whatLook=="profitFilter"){
                totProfit=parseFloat(totProfit)+parseFloat(item.resPrice)
                totRoom=parseInt(totRoom)+1
        }else 
        if(whatLook=="roomFilter"){
                if(Array.isArray(item.resRoomName)){
                    for(const ex of item.resRoomName){
                        if(ex==whatGet){
                            totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(ex==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==ex && ex==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==ex){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                            }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                            }
                        }
                    }
                }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                    }
                }else{
                    if(item.resRoomName==whatGet){
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(item.resRoomName==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){  
    if(g.roomName==item.resRoomName && item.resRoomName==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==item.resRoomName){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                }
            }
        }
    }
}

//table appendicizers

    await filterPlsPtB()
}

async function filterPlsPtB(){
console.log(roomGet.map(item=>`${item.roomName}`).join('\n'),roomArrayF.map(item=>`${item.roomName}`).join('<br>'))
console.log(arrayFlag+" "+totProfit+" "+totRoom+" "+totPaid+" "+totUnPaid+" "+totHfPaid)
document.getElementById('startD').valueAsDate=startDate
document.getElementById('endD').valueAsDate=endDate
const start=document.getElementById('startD')
const end=document.getElementById('endD')
const tbl=document.getElementById('dataBody')
//try-catch fetch reservation-data, for loop the data. replace arrayTest[e] with result or something
const response=await fetch('/reservation-data-r')
const result=await response.json()
for(const item of result){
    if(start.value<=item.resCheckinDate && item.resCheckinDate<=end.value){
        if(whatLook=="payStatFilter"){
            if(whatGet==item.resPayStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else 
        if(whatLook=="resStatFilter"){
            if(whatGet==item.resStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else 
        if(whatLook=="roomFilter"){
            if(Array.isArray(item.resRoomName)){
                    for(const ex of item.resRoomName){
                        if(ex==whatGet){
                            totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(ex==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==ex && ex==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==ex){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                    }
                                }
                            }
                        }
                    }
                }else{
                    if(item.resRoomName==whatGet){
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(item.resRoomName==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==item.resRoomName && item.resRoomName==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==item.resRoomName){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                }
        }else 
        if(whatLook=="profitFilter"){
            console.log(item.resPrice)
            console.log(totProfit)
            totProfit=parseFloat(totProfit)+parseFloat(item.resPrice)
            console.log(totProfit)
            totRoom=parseInt(totRoom)+1
        }
    }else{
        if(startDate==undefined && endDate==undefined){
        if(whatLook=="payStatFilter"){
            if(whatGet==item.resPayStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else 
        if(whatLook=="resStatFilter"){
            if(whatGet==item.resStat){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }else if(whatGet=="" || whatGet==undefined){
                const r=document.createElement('tr');
                r.innerHTML=`
                <td>${item.resCheckinDate}</td>
                <td>${item.resCheckoutDate}</td>
                <td>${item.resID}</td>
                <td>${item.resPayStat}</td>
                <td>${item.resStat}</td>
                `;
                tbl.appendChild(r)
            }
        }else
            if(whatLook=="profitFilter"){
                console.log(item.resPrice)
                console.log(totProfit)
            totProfit=parseFloat(totProfit)+parseFloat(item.resPrice)
            console.log(totProfit)
                totRoom=parseInt(totRoom)+1
        }else 
        if(whatLook=="roomFilter"){
                if(Array.isArray(item.resRoomName)){
                    for(const ex of item.resRoomName){
                        if(ex==whatGet){
                            totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(ex==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){
    if(g.roomName==ex && ex==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==ex){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                            }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                            }
                        }
                    }
                }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:ex,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                    }
                }else{
                    if(item.resRoomName==whatGet){
                        totRoom=parseInt(totRoom)+1
                            if(item.resPayStat=="Paid"){
                            totPaid=parseInt(totPaid)+1
                        }else if(item.resPayStat=="Unpaid"){
                            totUnPaid=parseInt(totUnPaid)+1  
                        }else if(item.resPayStat=="Half Paid"){
                            totHfPaid=parseInt(totHfPaid)+1
                        }
                        }else if(whatGet=="" || whatGet==undefined){
                            arrayFlag=1
                            for(const f of roomArrayF){
                                if(item.resRoomName==f.roomName){
                                    if(roomGet.length>0){
                                        for(const g of roomGet){  
    if(g.roomName==item.resRoomName && item.resRoomName==f.roomName && g.roomName == f.roomName){
        g.totRoom=parseInt(g.totRoom)+1
        if(item.resPayStat=="Paid"){
            g.totPaid=parseInt(g.totPaid)+1
        }else if(item.resPayStat=="Half Paid"){
            g.totHfPaid=parseInt(g.totHfPaid)+1
        }else if(item.resPayStat=="Unpaid"){
            g.totUnPaid=parseInt(g.totUnPaid)+1
        }
            }else{
                presentCount=0
                let is=0
                for(const fx of roomArrayF){
                for(const gx of roomGet){
                    if(fx.roomName==gx.roomName){
                    if(gx.roomName==item.resRoomName){
                    is=1
                        }
                    presentCount=parseInt(presentCount)+1
                                                }
                    }
                }
                if(presentCount<roomArrayF.length && is!=1){
                    if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:0,totPaid:0,totHfPaid:0,totUnPaid:0})
                                    }
                                                }
                                            }
                                        }
                                    }else{
                                        if(item.resPayStat=="Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:1,totHfPaid:0,totUnPaid:0})
                                    }else if(item.resPayStat=="Half Paid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:1,totUnPaid:0})
                                    }else if(item.resPayStat=="Unpaid"){
                                        roomGet.push({roomName:item.resRoomName,totRoom:1,totPaid:0,totHfPaid:0,totUnPaid:1})
                                    }
                                    }
                                }
                            }
                        }
                }
            }
        }
    }
}

//table appendicizers
if(whatLook=="profitFilter"){
    const r=document.createElement('tr');
                r.innerHTML=`
                <td>${start.value || "--"}</td>
                <td>${end.value || "--"}</td>
                <td>${totProfit}</td>
                <td>${totRoom}</td>
                `;
                tbl.appendChild(r)
    }else if(whatLook=="roomFilter"){
        console.log("table:"+whatGet+" "+totRoom+" "+totPaid+" "+totUnPaid)
        if(arrayFlag==1){
            console.log("aye")
            for(const f of roomArrayF){
            for(const g of roomGet){
                if(g.roomName==f.roomName){
                    const r=document.createElement('tr');
                r.innerHTML=`
                <td>${f.roomName}</td>
                <td>${g.totRoom}</td>
                <td>${g.totPaid}</td>
                <td>${g.totHfPaid}</td>
                <td>${g.totUnPaid}</td>
                `;
                tbl.appendChild(r)
                }
            }
            }
        }else{
            const r=document.createElement('tr');
                r.innerHTML=`
                <td>${whatGet}</td>
                <td>${totRoom}</td>
                <td>${totPaid}</td>
                <td>${totHfPaid}</td>
                <td>${totUnPaid}</td>
                `;
                tbl.appendChild(r)
        }
    }
}
//#endregion

//#region Change Filters Event
document.getElementById('FilterA').addEventListener('change',function(){
    const filter=document.getElementById('FilterA')
    const filterB=document.getElementById('FilterB')
    const filterC=document.getElementById('FilterC')
    const head=document.getElementById('dataHead')
    if(filter.options[filter.selectedIndex].text=="NO FILTER"){
        roomArrayF=[]
        const reservData=document.getElementById('dataBody');
        reservData.innerHTML=``
        filterC.innerHTML=''
        filterB.hidden=true
        filterC.hidden=true
        head.innerHTML=''
        const rh=document.createElement('tr')
        rh.innerHTML=`
            <th>Check In Date</th>
            <th>Check Out Date</th>
            <th>Reservation ID</th>
            <th>Customer Name</th>
            <th>Chosen Amenities</th>
            <th>Touring Package</th>
            <th>Total Price</th>
            <th>Running Balance</th>
            <th>Payment Status</th>
            <th>Reservation Status</th>
            `
        const opE=document.createElement('option')
        opE.textContent=""
        opE.value=""
        filterC.appendChild(opE)
        head.appendChild(rh)
        resData()
    }else if(filter.options[filter.selectedIndex].text=="Payment Status"){
        roomArrayF=[]
        filterB.hidden=false
        filterC.hidden=false
        filterC.innerHTML=''
        head.innerHTML=''
        const rh=document.createElement('tr')
            rh.innerHTML=`
            <th>Check In Date</th>
            <th>Check Out Date</th>
            <th>Reservation ID</th>
            <th>Payment Status</th>
            <th>Reservation Status</th>
            `
        const opA=document.createElement('option')
            opA.textContent="Paid"
            opA.value="payStatFilter"
        const opB=document.createElement('option')
            opB.textContent="Half Paid"
            opB.value="payStatFilter"
        const opC=document.createElement('option')
            opB.textContent="Unpaid"
            opB.value="payStatFilter"
        const opE=document.createElement('option')
            opE.textContent=""
            opE.value="payStatFilter"
            filterC.appendChild(opE)
            filterC.appendChild(opA)
            filterC.appendChild(opB)
            head.appendChild(rh)
            whatLook="payStatFilter"
            filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Reservation Status"){
        roomArrayF=[]
        filterB.hidden=false
        filterC.hidden=false
        filterC.innerHTML=''
        head.innerHTML=''
        const rh=document.createElement('tr')
            rh.innerHTML=`
            <th>Check In Date</th>
            <th>Check Out Date</th>
            <th>Reservation ID</th>
            <th>Payment Status</th>
            <th>Reservation Status</th>
            `
        const opA=document.createElement('option')
            opA.textContent="Reserved"
            opA.value="resStatFilter"
        const opB=document.createElement('option')
            opB.textContent="Checked In"
            opB.value="resStatFilter"
        const opC=document.createElement('option')
            opC.textContent="Checked Out"
            opC.value="resStatFilter"
        const opE=document.createElement('option')
            opE.textContent=""
            opE.value="resStatFilter"
        filterC.appendChild(opE)
        filterC.appendChild(opA)
        filterC.appendChild(opB)
        filterC.appendChild(opC)
        head.appendChild(rh)
        whatLook="resStatFilter"
        filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Chosen Room"){
        filterB.hidden=false
        filterC.hidden=false
        filterC.innerHTML=''
        head.innerHTML=''
        const rh=document.createElement('tr')
            rh.innerHTML=`
            <th>Room Name</th>
            <th>Total Reservations</th>
            <th>Paid Reservations</th>
            <th>Half Paid Reservations</th>
            <th>Unpaid Reservations</th>
            `
        const opA=document.createElement('option')
            opA.textContent="Funny Room"
            opA.value="roomFilter"
        const opB=document.createElement('option')
            opB.textContent="Funnier Room"
            opB.value="roomFilter"
        const opC=document.createElement('option')
            opC.textContent="The Funniest Room"
            opC.value="roomFilter"
        const opE=document.createElement('option')
            opE.textContent=""
            opE.value="roomFilter"
        filterC.appendChild(opE)
        /*
        filterC.appendChild(opA)
        filterC.appendChild(opB)
        filterC.appendChild(opC)
        */
        head.appendChild(rh)
        fetch('/room-data').then(response=>{
            if(response.ok){
                return response.json()
            }else{
                throw new Error('Error fetching data');
            }
        }).then(async data=>{
            for(const item of data){
                const op=document.createElement('option')
                op.value="roomFilter"
                op.textContent=item.roomName
                filterC.appendChild(op)
                console.log("pushing")
                roomArrayF.push({roomName:item.roomName})
            }
            whatLook="roomFilter"
            await filterPlsPtA()
        }).catch(error => {
                console.error('Error fetching data:', error);
            });
            
            
    }else if(filter.options[filter.selectedIndex].text=="Profit"){
        roomArrayF=[]
        filterB.hidden=false
        filterC.hidden=true
        filterC.innerHTML=''
        head.innerHTML=''
        const rh=document.createElement('tr')
            rh.innerHTML=`
            <th>From</th>
            <th>To</th>
            <th>Total Price</th>
            <th>Total Reservations</th>
            `
            const opE=document.createElement('option')
            opE.textContent=""
            opE.value="profitFilter"
        head.appendChild(rh)
        whatLook="profitFilter"
        filterPlsPtA()
        }
})
document.getElementById('FilterB').addEventListener('change',function(){
    //date shenanigans
    const currentDate = new Date();
    const filter=document.getElementById('FilterB')
    if(document.getElementById('FilterA').value=="Profit"){
        whatLook="profitFilter"
    }
    if(filter.options[filter.selectedIndex].text==""){
        startDate = undefined
        endDate = undefined
        filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Daily"){
        startDate = new Date(currentDate);
        endDate = new Date(currentDate);
        endDate.setDate(endDate.getDate() + 1);
        filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Weekly"){
        startDate = new Date(currentDate);
        endDate = new Date(currentDate);
        endDate.setDate(endDate.getDate() + 7);
        filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Monthly"){
        startDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
        endDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
        filterPlsPtA()
    }else if(filter.options[filter.selectedIndex].text=="Yearly"){
        startDate = new Date(currentDate.getFullYear(), 0, 1);
        endDate = new Date(currentDate.getFullYear(), 11, 32);
        filterPlsPtA()
    }
})

document.getElementById('FilterC').addEventListener('change',function(){
    //filters shtick
    const filterSource=document.getElementById('FilterC')
    let setting=filterSource.options[filterSource.selectedIndex].value
    let filter=filterSource.options[filterSource.selectedIndex].text
    if(setting==""){
        whatLook=setting
        whatGet=undefined
        filterPlsPtA()
    }else if(setting=="roomFilter"){
        whatLook=setting
        whatGet=filter
        filterPlsPtA()
    }else if(setting=="resStatFilter"){
        whatLook=setting
        whatGet=filter
        filterPlsPtA()
    }else if(setting=="payStatFilter"){
        whatLook=setting
        whatGet=filter
        filterPlsPtA()
    }else if(setting=="profitFilter"){
        whatLook=setting
        filterPlsPtA()
    }
})
//#endregion

async function printo(){
        const sectA=document.getElementById('FilterA').value
        const sectB=document.getElementById('FilterB').value
        const content = document.getElementById('datum').outerHTML;
        try{
            const response= await fetch('/generate-pdf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ sectA,sectB,content}),
      })
      if (!response.ok) {
            throw new Error('Failed to generate PDF');
        }
           const blob = await response.blob();
        const blobUrl = URL.createObjectURL(blob);

        // Create a link element
        const link = document.createElement('a');
        link.href = blobUrl;
        link.download = 'converted_file.pdf'; // Specify the filename for the downloaded file
        document.body.appendChild(link);

        // Trigger the download
        link.click();

        // Clean up
        URL.revokeObjectURL(blobUrl);
        document.body.removeChild(link);
} catch (error) {
console.error('Error:', error);
alert('An error occurred. Please try again later.');
}}
    
    async function logout(){
        const datum={
         it:"admin"   
        }
        try{
            const response=await fetch('/applyCurrentActive',{
            method:'POST',
            headers:{
            'Content-Type':'application/json'
            },
            body:JSON.stringify(datum)
            })
            if(response.ok){
                        window.location.replace("LogIn.html")
            }
            }catch(err){
            console.log(err)
            }
    }
    </script>
</body>
